# ROS2Sonic

![](https://usf-comit.github.io/ros2sonic/ros2sonic_logo_200.png)

## About
The ROS2Sonic package is a ROS2 driver designed to receive data from a R2Sonic multibeam and re-publish the data as a relevant ROS message.

**Refer [Complete API documentation](https://usf-comit.github.io/ros2sonic/) for additional details**

> **NOTE:**  This project is currently in pre-release.  It has been tested with R2Sonic hardware but the interface is subject to change until the first major release.   

## Installation ##

This project can be installed like any other ROS2 source package

### Begin by getting the package the dependencies ###

First clone the package to your ROS workspace **source** directory
```
git clone https://github.com/USF-COMIT/ros2sonic.git
```

This package uses the marine_messages package. Clone them to your work space's src directory

```
git clone -b ros2 https://github.com/apl-ocean-engineering/marine_msgs.git
```

The rest of the dependencies can be acquired through rosdep.   Run the following command from your workspace root directory.
```
rosdep install --from-paths src -y --ignore-src
```

### Compile
Finally you can compile the package from the root directory of your ros workspace
```
colcon build
```


## Getting Started
This package has a sample launch file for testing.  You may need to edit or create your own `r2sonic/params/bench_test.yaml` to match the port numbers of your unit.

The driver can be started with the following command
```
ros2 launch r2sonic bench_test.py
```

## Additional Utilities ##

There are a few other packages associated with the [marine_msgs](https://github.com/apl-ocean-engineering/marine_msgs) standards that may be useful for processing and visualizing data generated by this driver.

**[Acoustic Msgs Tools](https://github.com/k2oceanic/acoustic_msgs_tools)** Is a collection of tools to view and interpret messages in the [marine_msgs](https://github.com/apl-ocean-engineering/hydrographic_msgs) package.
![wc_gui2-2022-02-22_15 21 30](https://user-images.githubusercontent.com/23006525/155218007-6cd1ff3e-8736-47ba-ba1b-50a0fee31345.gif)

## Parameters ##

```

topics:                                 # Any topic specified with an empty string , "", will not be computed or published.
    detections:     "~/detections"      # The topic to publish your acoustic_msgs::msg::Detections
    bth0:           "~/raw/bth0"        # The topic to publish raw bathy data

ports:
    bathy:          4000 #65500         # The port you are receiving bathy data on

sonar_ip:           "10.0.0.86"         # The IP address of the sonar.  This is where you will send sonar commands.
                                        # does not need to be specified if you are listen only

interface_ip:       "0.0.0.0"           # The IP of the interface you want to listen on.  Default ["0.0.0.0"]
                                        # If you want to listen on all interfaces specify "0.0.0.0"

tx_frame_id:        "r2sonic_tx"        # The frame id of the acoustic transmitter

rx_frame_id:        "r2sonic_rx"        # The frame id of the acoustic receiver

```

## Credits

This package was created by Kris Krasnosky of the [USF COMIT](https://github.com/USF-COMIT) group and offered under the Apache 2.0 License.
